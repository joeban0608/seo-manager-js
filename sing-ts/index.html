<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <div id="category-buttons"></div>
    <!--  用來顯示文章分類按鈕  -->
    <div id="blog-posts"></div>
    <!--  用來顯示文章列表  -->
    <div id="pagination"></div>
    <!--  用來顯示分頁按鈕  -->
    <style>
      body {
        width: 100dvw;
        height: 100dvh;
      }
      /* 使用 Masonry Layout 實現瀑布流布局 */
      #blog-posts {
        column-count: 3;
        column-gap: 20px; /* 調整列間距 */
      }
      .blog-post {
        background-color: #000000; /* 改為黑色背景 */
        border-radius: 8px;
        display: inline-block;
        margin-bottom: 20px;
        width: 100%;
        break-inside: avoid; /* 避免文章塊被拆分 */
        overflow: hidden;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        text-decoration: none;
        transition: none; /* 移除過渡效果 */
      }
      .blog-image img {
        width: 100%;
        height: auto;
        display: block;
        border-bottom: 4px solid #ff0000; /* 圖片下方邊框改為鮮紅色 */
      }
      .blog-content {
        padding: 20px;
        font-family: "Exo", sans-serif;
      }
      /* 標題、日期和分類樣式 */
      .post-date {
        font-size: 10px;
        font-weight: 600;
        color: #ff0000; /* 日期文字顏色改為鮮紅色 */
        margin-bottom: 5px;
        font-family: "Exo", sans-serif;
      }
      .blog-content h2 {
        font-size: 20px;
        font-weight: 700;
        color: #ffffff;
        margin-bottom: 5px;
        line-height: 1.2;
      }
      .blog-content p {
        font-size: 14px;
        font-weight: 300;
        color: #a0aec0;
        margin-bottom: 5px;
        line-height: 1.4;
      }
      .category-label {
        display: inline-block;
        background-color: #ff0000; /* 分類標籤改為鮮紅色 */
        color: #000000; /* 標籤文字顏色為黑色 */
        padding: 5px 10px;
        border-radius: 20px;
        font-size: 10px;
        font-weight: 600;
        margin-top: 10px;
      }
      /* 分頁按鈕樣式 */
      #pagination {
        display: flex;
        justify-content: center;
        margin-top: 20px;
      }
      #pagination button {
        background-color: #000000; /* 分頁按鈕背景改為黑色 */
        color: #ffffff;
        border: 1px solid #ff0000; /* 邊框改為鮮紅色 */
        padding: 10px 15px;
        margin: 0 5px;
        cursor: pointer;
        font-family: "Exo", sans-serif;
        transition: none;
      }
      #pagination button.active,
      #pagination button:hover {
        background-color: #ff0000; /* 活動或懸停狀態的按鈕背景改為鮮紅色 */
        color: #000000; /* 活動或懸停狀態的文字顏色改為黑色 */
      }
      #pagination button:disabled {
        background-color: #a0aec0;
        cursor: not-allowed;
      }
      /* 分類按鈕樣式，靠左對齊 */
      #category-buttons {
        display: flex;
        justify-content: flex-start; /* 改為靠左對齊 */
        margin-bottom: 20px; /* 與文章內容的間距 */
        flex-wrap: wrap; /* 如果按鈕太多，讓它們換行 */
      }
      #category-buttons button {
        background-color: #000000; /* 分類按鈕背景改為黑色 */
        color: #ffffff;
        border: 1px solid #ff0000; /* 邊框改為鮮紅色 */
        padding: 10px 15px;
        margin: 5px; /* 確保按鈕之間有間距 */
        cursor: pointer;
        font-family: "Exo", sans-serif;
        border-radius: 100px; /* 圓角設為100px */
        transition: none;
        font-size: 14px;
      }
      #category-buttons button.active,
      #category-buttons button:hover {
        background-color: #ff0000; /* 活動或懸停狀態的按鈕背景改為鮮紅色 */
        color: #000000; /* 活動或懸停狀態的文字顏色改為黑色 */
      }
      #category-buttons button:disabled {
        background-color: #a0aec0;
        cursor: not-allowed;
      }
      /* 手機版樣式 */
      @media (max-width: 768px) {
        #blog-posts {
          column-count: 1; /* 手機版每行顯示一個文章 */
          column-gap: 0; /* 移除列間距 */
        }
        .blog-post {
          width: 100%;
          margin-bottom: 20px;
        }
        .post-date {
          font-size: 12px;
        }
        .blog-content h2 {
          font-size: 18px; /* 手機版標題字體稍微縮小 */
        }
        .blog-content p {
          font-size: 14px; /* 手機版字體稍微縮小 */
        }
        #category-buttons {
          justify-content: center; /* 手機版按鈕居中對齊 */
        }
        #category-buttons button {
          flex: 1 1 auto; /* 讓按鈕根據屏幕寬度調整大小 */
          padding: 10px 5px; /* 調整手機版按鈕內邊距 */
        }
      }
    </style>
  </head>
  <body>
    <script type="module">
      import { marked } from "https://cdn.jsdelivr.net/npm/marked/lib/marked.esm.js";

      // https://seo-manager.wows-ai.dev/api/article?id={id}
      const apiUrl = "https://seo-manager.wows-ai.dev/api/article"; // 每頁最多抓取 100 篇文章
      const article_id = "pr14QyolSnRKIkFHG9uV";
      let postInfo = null; // 存儲所有文章
      // 加載所有頁面的文章，直到抓取完畢
      async function fetchPosts() {
        const url = `${apiUrl}?id=${article_id}`;
        try {
          const response = await fetch(url); // 按頁面逐次抓取
          if (!response.ok) throw new Error("Error fetching posts");
          const getPostRes = await response.json();
          if (!getPostRes?.data) throw new Error("post data is empty");
          postInfo = getPostRes.data;
          // 如果抓取的文章數量小於每頁的最大值，代表已經抓取完所有文章
          // 只保留分類為 "Slot games" 和 "318Promo" 的文章
          // 隨機排列文章
          displayPosts(); // 顯示當前頁面的文章
        } catch (error) {
          console.error("Error fetching WordPress posts:", error);
          return { error: `Error fetching WordPress posts: ${error}` };
        }
      }

      // 顯示當前頁面的文章
      function displayPosts() {
        // 如果選擇了分類，根據分類過濾文章
        let postsHTML = "";
        if (!postInfo) {
          postsHTML = "Post in not found";
          return;
        }

        const postDate = new Date(postInfo.updated_at).toLocaleDateString(
          "en-US",
          {
            year: "numeric",
            month: "long",
            day: "numeric",
          }
        );

        postsHTML += `
          <div class="blog-post" onclick="redirectToPost(${postInfo.title})">
            <div class="blog-image">
              <img src="${postInfo.cover_url}" alt="${postInfo.title}">
            </div>
            <div class="blog-content">
              <div class="post-date">${postDate}</div>
              <h2>${postInfo.title}</h2>
              <p>${marked.parse(postInfo.content)}</p>
            </div>
          </div>
        `;
        document.getElementById("blog-posts").innerHTML = postsHTML;
      }
      // 顯示分頁按鈕

      // 跳轉到文章詳細頁面
      function redirectToPost(postId) {
        window.location.href = `/posts?post_id=${postId}`;
      }

      // 初始化
      document.addEventListener("DOMContentLoaded", function () {
        fetchPosts(); // 每次載入時抓取並顯示文章
      });
    </script>
  </body>
</html>
